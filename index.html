<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube Clone - Advanced</title>
    <style>
        /* --- CSS VARIABLES & RESET --- */
        :root {
            --bg-color: #f9f9f9;
            --header-bg: #ffffff;
            --sidebar-bg: #ffffff;
            --text-main: #0f0f0f;
            --text-sec: #606060;
            --border-color: #e5e5e5;
            --hover-color: #f2f2f2;
            --accent-color: #cc0000;
            --card-bg: #ffffff;
            --scroll-thumb: #cccccc;
        }

        [data-theme="dark"] {
            --bg-color: #0f0f0f;
            --header-bg: #0f0f0f;
            --sidebar-bg: #0f0f0f;
            --text-main: #f1f1f1;
            --text-sec: #aaaaaa;
            --border-color: #303030;
            --hover-color: #272727;
            --accent-color: #ff0000;
            --card-bg: #0f0f0f;
            --scroll-thumb: #717171;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Roboto', sans-serif; }
        body { background-color: var(--bg-color); color: var(--text-main); overflow-x: hidden; transition: background 0.3s, color 0.3s; }
        
        /* --- SCROLLBAR --- */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: var(--scroll-thumb); border-radius: 4px; }

        /* --- LAYOUT --- */
        .app-container { display: flex; flex-direction: column; height: 100vh; }
        
        /* --- HEADER --- */
        header {
            height: 56px;
            background: var(--header-bg);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 16px;
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 100;
            border-bottom: 1px solid var(--border-color);
        }

        .logo-area { display: flex; align-items: center; gap: 16px; }
        .menu-icon { cursor: pointer; padding: 8px; border-radius: 50%; }
        .menu-icon:hover { background: var(--hover-color); }
        .logo { display: flex; align-items: center; gap: 4px; font-weight: bold; font-size: 18px; letter-spacing: -0.5px; cursor: pointer; }
        .logo svg { height: 20px; fill: var(--accent-color); }

        .search-area { flex: 1; max-width: 600px; display: flex; align-items: center; margin: 0 20px; }
        .search-box {
            display: flex;
            width: 100%;
            border: 1px solid var(--border-color);
            border-radius: 40px;
            overflow: hidden;
            background: var(--bg-color);
        }
        .search-box input {
            flex: 1;
            padding: 0 16px;
            height: 40px;
            border: none;
            background: transparent;
            color: var(--text-main);
            font-size: 16px;
            outline: none;
        }
        .search-btn {
            width: 64px;
            background: var(--hover-color);
            border: none;
            border-left: 1px solid var(--border-color);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .search-btn svg { width: 20px; fill: var(--text-main); }

        .user-area { display: flex; align-items: center; gap: 15px; }
        .theme-toggle { cursor: pointer; padding: 8px; border-radius: 50%; }
        .theme-toggle:hover { background: var(--hover-color); }

        /* --- MAIN CONTENT AREA --- */
        .main-body {
            display: flex;
            margin-top: 56px;
            height: calc(100vh - 56px);
        }

        /* --- SIDEBAR --- */
        aside {
            width: 240px;
            background: var(--sidebar-bg);
            overflow-y: auto;
            padding: 12px;
            display: none; /* Hidden on mobile default */
        }
        @media (min-width: 768px) { aside { display: block; } }

        .nav-item {
            display: flex;
            align-items: center;
            padding: 0 12px;
            height: 40px;
            border-radius: 10px;
            cursor: pointer;
            color: var(--text-main);
            margin-bottom: 4px;
        }
        .nav-item:hover { background-color: var(--hover-color); }
        .nav-item.active { background-color: var(--hover-color); font-weight: 500; }
        .nav-icon { margin-right: 24px; width: 24px; height: 24px; display: flex; align-items: center; justify-content: center;}
        .nav-text { font-size: 14px; }
        .divider { height: 1px; background: var(--border-color); margin: 12px 0; }

        /* --- VIDEO GRID (HOME) --- */
        .content-area {
            flex: 1;
            background: var(--bg-color);
            padding: 24px;
            overflow-y: auto;
        }

        .video-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
        }

        .video-card { cursor: pointer; transition: transform 0.2s; }
        .video-card:hover .thumbnail img { transform: scale(1.02); }
        
        .thumbnail {
            width: 100%;
            aspect-ratio: 16/9;
            background: #333;
            border-radius: 12px;
            overflow: hidden;
            position: relative;
        }
        .thumbnail img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.2s; }
        
        .video-info { display: flex; gap: 12px; margin-top: 12px; }
        .channel-icon { width: 36px; height: 36px; border-radius: 50%; background: #aaa; flex-shrink: 0; }
        .details { flex: 1; }
        .video-title { font-size: 16px; font-weight: 500; line-height: 1.4; margin-bottom: 6px; color: var(--text-main); display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
        .channel-name, .meta-data { font-size: 14px; color: var(--text-sec); }
        
        /* --- WATCH PAGE (PLAYER) --- */
        .watch-section { display: none; flex-direction: column; }
        @media (min-width: 1000px) { .watch-section { flex-direction: row; gap: 24px; } }

        .player-container { flex: 1; }
        .video-frame {
            width: 100%;
            aspect-ratio: 16/9;
            background: #000;
            margin-bottom: 16px;
        }
        .video-frame iframe { width: 100%; height: 100%; border: none; }
        
        .watch-details h1 { font-size: 20px; color: var(--text-main); margin-bottom: 10px; }
        .watch-stats { display: flex; justify-content: space-between; align-items: center; padding-bottom: 12px; border-bottom: 1px solid var(--border-color); }
        .watch-meta { color: var(--text-sec); font-size: 14px; }

        .related-list { width: 100%; margin-top: 20px; }
        @media (min-width: 1000px) { .related-list { width: 350px; margin-top: 0; } }

        .related-card { display: flex; gap: 8px; margin-bottom: 12px; cursor: pointer; }
        .related-thumb { width: 168px; height: 94px; background: #333; border-radius: 8px; overflow: hidden; flex-shrink: 0; }
        .related-thumb img { width: 100%; height: 100%; object-fit: cover; }
        .related-info h4 { font-size: 14px; color: var(--text-main); margin-bottom: 4px; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
        .related-info p { font-size: 12px; color: var(--text-sec); }

        /* --- UTILS --- */
        .hidden { display: none !important; }
        .error-msg { text-align: center; padding: 40px; color: var(--text-sec); font-size: 18px; }
        
        /* SVG ICONS color */
        svg { fill: var(--text-main); }
    </style>
</head>
<body>

<div class="app-container">
    <header>
        <div class="logo-area">
            <div class="menu-icon" onclick="toggleSidebar()">
                <svg height="24" viewBox="0 0 24 24" width="24"><path d="M21 6H3V5h18v1zm0 5H3v1h18v-1zm0 6H3v1h18v-1z"></path></svg>
            </div>
            <div class="logo" onclick="goHome()">
                <svg height="24" viewBox="0 0 24 24" width="24" style="fill: #ff0000;"><path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"></path></svg>
                <span style="color: var(--text-main);">YouTube</span>
            </div>
        </div>

        <div class="search-area">
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="Search">
                <button class="search-btn" onclick="performSearch()">
                    <svg height="24" viewBox="0 0 24 24" width="24"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path></svg>
                </button>
            </div>
        </div>

        <div class="user-area">
            <div class="theme-toggle" onclick="toggleTheme()" title="Toggle Dark Mode">
                <svg height="24" viewBox="0 0 24 24" width="24"><path d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9 9-4.03 9-9c0-.46-.04-.92-.1-1.36-.98 1.37-2.58 2.26-4.4 2.26-2.98 0-5.4-2.42-5.4-5.4 0-1.81.89-3.42 2.26-4.4-.44-.06-.9-.1-1.36-.1z"></path></svg>
            </div>
            <div class="channel-icon" style="background-color: #555; color: white; display:flex; align-items:center; justify-content:center; font-size:12px;">YOU</div>
        </div>
    </header>

    <div class="main-body">
        <aside id="sidebar">
            <div class="nav-item active" onclick="goHome()">
                <div class="nav-icon"><svg viewBox="0 0 24 24" preserveAspectRatio="xMidYMid meet" focusable="false" style="pointer-events: none; display: block; width: 24px; height: 24px;"><g><path d="M4 21V10.08l8-6.96 8 6.96V21h-6v-6h-4v6H4z"></path></g></svg></div>
                <div class="nav-text">Home</div>
            </div>
            <div class="nav-item">
                <div class="nav-icon"><svg viewBox="0 0 24 24" height="24" width="24"><path d="M17.53 11.2c-.23-.3-.5-.56-.76-.82-.65-.66-1.71-1.03-2.78-1.06-1.1-.04-2.15.28-2.77.93l-3.8 3.8c-1.16 1.16-1.4 2.95-.48 4.34l1.5-1.5c-.25-.55-.17-1.18.24-1.59l3.8-3.8c.29-.29.72-.38 1.09-.26.37.12.65.42.74.8l-5.2 5.2-1.41-1.42L13.3 9.4l-.7-.71L6.2 15.1c-1.41-1.41-1.41-3.69 0-5.1l3.8-3.8c1.16-1.16 2.95-1.4 4.34-.48l-1.5 1.5c-.55-.25-1.18-.17-1.59.24l-3.8 3.8c-1.17 1.17-1.17 3.07 0 4.24l6.48-6.49zm3.21-2.12l-1.5 1.5c.25.55.17 1.18-.24 1.59l-3.8 3.8c-.29.29-.72.38-1.09.26-.37-.12-.65-.42-.74-.8l5.2-5.2 1.41 1.42 6.4 6.4.7.71-6.4-6.4c1.41 1.41 1.41 3.69 0 5.1l-3.8 3.8c-1.16 1.16-2.95 1.4-4.34.48l1.5-1.5c.55.25 1.18.17 1.59-.24l3.8-3.8c1.17-1.17 1.17-3.07 0-4.24l-6.48 6.49z"></path></svg></div>
                <div class="nav-text">Shorts</div>
            </div>
            <div class="nav-item">
                <div class="nav-icon"><svg viewBox="0 0 24 24" height="24" width="24"><path d="M18.7 8.7H5.3V7h13.4v1.7zm-1.7-5H7v1.6h10V3.7zm3.3 8.3v6.7c0 1-.7 1.6-1.6 1.6H5.3c-1 0-1.6-.7-1.6-1.6V12c0-1 .7-1.7 1.6-1.7h13.4c1 0 1.6.8 1.6 1.7zm-5 3.3l-5-2.7v5.4l5-2.7z"></path></svg></div>
                <div class="nav-text">Subscriptions</div>
            </div>
            <div class="divider"></div>
            <div class="nav-item">
                <div class="nav-icon"><svg viewBox="0 0 24 24" height="24" width="24"><path d="M11 7l6 3.5-6 3.5V7zm7 13H4V6H3v15h15v-1zm3-2H6V3h15v15zM7 17h13V4H7v13z"></path></svg></div>
                <div class="nav-text">Library</div>
            </div>
        </aside>

        <main class="content-area">
            
            <div id="video-grid" class="video-grid">
                </div>

            <div id="watch-view" class="watch-section">
                <div class="player-container">
                    <div class="video-frame">
                        <div id="player-placeholder"></div>
                    </div>
                    <div class="watch-details">
                        <h1 id="main-title">Video Title</h1>
                        <div class="watch-stats">
                            <span id="main-channel">Channel Name</span>
                            <div class="watch-meta" id="main-meta">100K views â€¢ 1 day ago</div>
                        </div>
                        <div style="margin-top:10px; font-size:14px; color:var(--text-main); background:var(--hover-color); padding:10px; border-radius:8px;" id="main-desc">
                            Description here...
                        </div>
                    </div>
                </div>
                
                <div class="related-list" id="related-list">
                    </div>
            </div>

        </main>
    </div>
</div>

<script>
    /**
     * ==========================================
     * CONFIGURATION & STATE
     * ==========================================
     */
    // ðŸ”´ IMPORTANT: Replace this with your actual YouTube Data API v3 Key
    const API_KEY = "YOUR_API_KEY_HERE"; 
    
    const state = {
        theme: localStorage.getItem('theme') || 'light',
        currentView: 'home', // 'home' or 'watch'
        videos: [], // Store fetched videos
        lastQuery: 'programming' // Default search
    };

    /**
     * ==========================================
     * INITIALIZATION
     * ==========================================
     */
    document.addEventListener('DOMContentLoaded', () => {
        applyTheme(state.theme);
        
        // Press Enter to Search
        document.getElementById('searchInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') performSearch();
        });

        // Initial load
        if(API_KEY === "YOUR_API_KEY_HERE") {
            showError("Please open the file code and add your YouTube Data API Key at the top of the script section.");
        } else {
            searchVideos(state.lastQuery);
        }
    });

    /**
     * ==========================================
     * API LOGIC
     * ==========================================
     */
    async function searchVideos(query) {
        state.lastQuery = query;
        const grid = document.getElementById('video-grid');
        grid.innerHTML = '<p style="grid-column: 1/-1; text-align:center;">Loading...</p>';
        
        try {
            const response = await fetch(`https://www.googleapis.com/youtube/v3/search?part=snippet&maxResults=24&q=${encodeURIComponent(query)}&type=video&key=${API_KEY}`);
            const data = await response.json();

            if(data.error) {
                throw new Error(data.error.message);
            }

            state.videos = data.items;
            renderGrid(state.videos);
        } catch (err) {
            showError(`Error: ${err.message}. <br>Check console or API Key quota.`);
            console.error(err);
        }
    }

    async function performSearch() {
        const query = document.getElementById('searchInput').value;
        if(!query) return;
        goHome();
        searchVideos(query);
    }

    /**
     * ==========================================
     * UI RENDERING
     * ==========================================
     */
    function renderGrid(videos) {
        const grid = document.getElementById('video-grid');
        grid.innerHTML = '';

        if(!videos || videos.length === 0) {
            grid.innerHTML = '<p>No results found.</p>';
            return;
        }

        videos.forEach(video => {
            const snippet = video.snippet;
            const card = document.createElement('div');
            card.className = 'video-card';
            card.onclick = () => openPlayer(video);
            
            // Mock random views since Search API doesn't return statistics to save quota
            const views = Math.floor(Math.random() * 900) + 10 + 'K';
            const time = timeSince(new Date(snippet.publishedAt));

            card.innerHTML = `
                <div class="thumbnail">
                    <img src="${snippet.thumbnails.medium.url}" alt="${snippet.title}">
                </div>
                <div class="video-info">
                    <div class="channel-icon" style="background-image: url('${snippet.thumbnails.default.url}'); background-size: cover;"></div>
                    <div class="details">
                        <h3 class="video-title">${snippet.title}</h3>
                        <div class="channel-name">${snippet.channelTitle}</div>
                        <div class="meta-data">${views} views â€¢ ${time}</div>
                    </div>
                </div>
            `;
            grid.appendChild(card);
        });
    }

    function renderRelated(currentId) {
        const list = document.getElementById('related-list');
        list.innerHTML = '<h3>Recommended</h3>';

        // Filter out current video from state.videos to mock "related" without extra API cost
        const related = state.videos.filter(v => v.id.videoId !== currentId);

        related.forEach(video => {
            const snippet = video.snippet;
            const item = document.createElement('div');
            item.className = 'related-card';
            item.onclick = () => openPlayer(video);

            item.innerHTML = `
                <div class="related-thumb">
                    <img src="${snippet.thumbnails.medium.url}">
                </div>
                <div class="related-info">
                    <h4>${snippet.title}</h4>
                    <p>${snippet.channelTitle}</p>
                    <p style="font-size:11px;">${timeSince(new Date(snippet.publishedAt))}</p>
                </div>
            `;
            list.appendChild(item);
        });
    }

    /**
     * ==========================================
     * PLAYER LOGIC
     * ==========================================
     */
    function openPlayer(video) {
        const videoId = video.id.videoId;
        const snippet = video.snippet;

        // Switch UI
        document.getElementById('video-grid').classList.add('hidden');
        document.getElementById('watch-view').classList.remove('hidden');
        document.getElementById('watch-view').style.display = 'flex'; // enforce flex
        state.currentView = 'watch';

        // Set Iframe
        const frameContainer = document.querySelector('.video-frame');
        frameContainer.innerHTML = `<iframe src="https://www.youtube.com/embed/${videoId}?autoplay=1" allow="autoplay; encrypted-media" allowfullscreen></iframe>`;

        // Set Details
        document.getElementById('main-title').innerText = snippet.title;
        document.getElementById('main-channel').innerText = snippet.channelTitle;
        document.getElementById('main-meta').innerText = `Published on ${new Date(snippet.publishedAt).toLocaleDateString()}`;
        document.getElementById('main-desc').innerText = snippet.description || 'No description available.';

        // Render Recommended
        renderRelated(videoId);
        
        // Scroll to top
        window.scrollTo(0, 0);
    }

    function goHome() {
        document.getElementById('video-grid').classList.remove('hidden');
        document.getElementById('watch-view').classList.add('hidden');
        document.getElementById('watch-view').style.display = 'none';
        
        // Stop video playback by clearing iframe
        document.querySelector('.video-frame').innerHTML = '<div id="player-placeholder"></div>';
    
